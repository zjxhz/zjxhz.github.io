---
layout: post
title: Android开发集成地图 
description: 描述在Android开发中如何集成地图功能
category: articles
tags: ['android','安卓','地图', 'app', 'map']
---

## 需求
最近在开发一个安卓的应用，在应用中需要在地图上显示一些地点（经纬度已知）。点击这些地点可以显示名字，继续点击名字可以显示详情或者导航之类的。

## 选择一：谷歌地图
开发安卓应用，首先想到的当然是用谷歌地图。开发和配置都比较简单，不用多少代码可以支持2.3以上的安卓版本。但是这么做有几个问题。

* 最致命的是：要在手机上使用该功能，需要用户手机上安装了较新版本的Google Play Service（貌似还不是Google Play Store，而且在Store中直接搜索是找不到的）。这对于大部分国产安卓手机来讲太麻烦了，甚至有的根本不支持。好笑的是，似乎在安卓模拟器中都无法使用该功能。
* 地图加载速度比较慢。

## 选择二：百度地图
对于国人而言，百度地图似乎是不错的选择。百度地图API支持新旧版本的API。一开始我下载了最新的SDK，试图使用新版API。但是其文档比较糟糕，内容和实现有较大差距，一下子也没配置成功。就发了一封反馈邮件给百度，回复得还比较快。大约半天左右，对方丢过来一个doc文档，让我看着做。不过那时我已经在用旧版SDK和API了，就没管。

但是旧版API有一些问题，例如点击地图上的点弹出名称这个简单的功能，却没法很简单的办法完成，因为弹出菜单只支持传入图片（Bitmap），而不是一个View。这对于只是需要简单地显示一个名字这样的功能而言，太麻烦了一点。于是又回头去看那个doc文档，最终把新版SDK和Access Token配置好了。新版的弹出菜单支持传入一个View参数，这样就可以用一个带文字和背景图片的Button来显示了。

说下百度地图的几个不足吧：

* 文档比较糟糕，过时。
* 示例代码写得比较难看。
* 完成简单的功能需要大量的代码，比如我这个需求，用谷歌地图大约只有10行左右的代码，用百度地图却足足用了大约100行代码。
* API也不太好用，例如为了创建一个GeoPoint来表示一个位置。需要这样：new GeoPoint((int) (latitude * 1E6), (int) (longitude * 1E6)); 代码实在是难看得很。为什么不直接使用浮点的经纬度来作为参数呢？

好处当然是不需要再安装其他服务就可以直接使用，在中国使用也会比谷歌地图更快一点。虽然比较难用，但也只能用百度地图了。

## iOS中集成地图
这个是题外话了。不过我之前做的iOS应用，显示地图就简单多了。在Apple推出自己的地图之前，可以用谷歌地图，如果没有安装谷歌地图（绝大部分人会装），则直接用浏览器打开，也可以导航什么的。在Apple推出自己的地图之后，就可以用Apple自带的地图了。虽然Apple的地图被抨击说不太好用，但是对于简单的需求实现起来也没有什么问题。
