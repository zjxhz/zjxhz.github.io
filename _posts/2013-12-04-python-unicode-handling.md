---
layout: post
titile: Python如何处理Unicode
description: 介绍在Python中如何处理Unicode
category: articles
tag: [python, unicode]
---
## Unicode简史
在早期，计算机上的字符都是英文的，外加一些阿拉伯数字、标点、空格之类的，所有这些加起来在256个以内。所以原来的8位计算机可以用一个字节来表示所有的这些字符。甚至，还用不到8位，低4位就足够表示所有的这些字符了。但是随着计算机的流行，尤其是Internet的出现，其他国家的人们发现自己的语言无法用这128个字符表示。

于是一些聪明的人就想到，为何我不用高4位来表示自己的语言呢？他们这么想了，也这么做了。所以，对于不同的计算机而言，高4位可能放着法语，可能是芬兰语，也可能是俄语。可是当一个国家的人向另外一个国家的人发邮件，问题就来了：相同的数字（code point）对应的是不同的字符。于是一封法语邮件到了俄罗斯国家就成了完全混乱的俄文。

而这只是其中的一个问题。在亚洲，比如中国，256个字符根本无法容纳所有中文。所以，后来，Unicode出现了。基本的思想是用更多的字节来对应一个文字。比如用两个，那么至少可以表示65536个字符。这看起来差不多可以容纳世界上所有的文字了。但是这造成了空间上的浪费：原来只需一个字节，现在需要两个，增加了一倍。对于内存和硬盘空间日渐增大的趋势下，这似乎问题不大。不过对于需要在网络上传输的文字来讲，这是个挺大的开销——虽然网速也快了，但是用户也在快速地增长。

这里说的只是文字和数字之间的对应关系，还没有讲到这些数字应该如何在文件或者内存中表示。而这里面又有很多复杂的问题：比如对于小于256的数字，是用高位来填充00，还是用低位？加上前面所说的空间浪费的问题，用两个字节来表示一个文字的做法并不流行。

于是出现了UTF-8，这是一种文字编码的方式。对于常用的字符，如英文，可以用一个字节表示。其他的用两个，或者三个，最长的可以用到6个字节。虽然看起来有点多，但是实际上它比总是用两个字节表示更节省空间。这里有个问题是，如果一个文字对应的字节长度不是固定的，那么在比如读取文件的时候，我怎么知道一次该读取几个字节呢？答案在于UTF-8的高位编码。例如对于一个字节表示的文字，其最高位为0。对于两个字节的，高字节的前三位是110，低字节的高位是10。以此类推。所以，只要读到第一个字节，你就可以知道下面的这个文字占用了几个字节。
